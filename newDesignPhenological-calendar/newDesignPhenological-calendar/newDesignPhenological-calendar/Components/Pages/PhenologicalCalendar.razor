@page "/phenological-calendar"
@rendermode InteractiveServer
@using Microsoft.AspNetCore.Components
@using System.Collections.Generic
@inject DataService DataService

<PageTitle>Вырастим вместе</PageTitle>

<div class="px-4 py-5 my-3 text-center" style="padding: 24px;">
    <div class="d-block mx-auto mb-4">
        <svg xmlns="http://www.w3.org/2000/svg" width="72" height="57" fill="currentColor" class="bi bi-calendar-week-fill" viewBox="0 0 16 16">
            <path d="M4 .5a.5.5 0 0 0-1 0V1H2a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2h-1V.5a.5.5 0 0 0-1 0V1H4zM16 14V5H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M9.5 7h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5m3 0h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5M2 10.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5" />
        </svg>
    </div>
    <h1 class="display-5 fw-bold text-body-emphasis">Фенологический календарь</h1>

    @*<form class="parent d-flex" role="search">
			<input class="form-control me-2" type="search" placeholder="Введите вредителя" aria-label="Search">
			$1$ <button class="btn btn-outline-success" type="submit">Найти</button> #1#
		</form>
	<footer class="text-body-secondary"></footer>
	<div class="col-lg-6 mx-auto"> 

		$1$ <p class="lead mb-4">Quickly design and customize responsive mobile-first sites with Bootstrap, the world’s most popular front-end open source toolkit, featuring Sass variables and mixins, responsive grid system, extensive prebuilt components, and powerful JavaScript plugins.</p> #1#
		<div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
			<button type="button" class="btn btn-primary btn-lg px-4 gap-3">Информация</button>
			$1$<button type="button" class="btn btn-outline-secondary btn-lg px-4">Расчитать календарь</button>#1#
			
		</div>
	</div> *@
    @*<form class="parent d-flex" role="search">
        <input class="form-control me-2" type="search" placeholder="Введите вредителя" aria-label="Search">
        <button type="button" class="btn btn-primary">Информация</button>
        $1$ <button class="btn btn-outline-success" type="submit">Найти</button> #1#
    </form>*@
    <footer class="text-body-secondary"></footer>
    <div class="col-lg-6 mx-auto"> 
        @* <p class="lead mb-4">Quickly design and customize responsive mobile-first sites with Bootstrap, the world’s most popular front-end open source toolkit, featuring Sass variables and mixins, responsive grid system, extensive prebuilt components, and powerful JavaScript plugins.</p> *@
        <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
            @*<button type="button" class="btn btn-outline-secondary btn-lg px-4">Расчитать календарь</button>*@
        </div>
    </div> 
</div>

<div class="bg-image-search" style="background-image: url(@linkImg);">
    <div class="container py-4">
        <div class="p-5 mb-4 bg-body-tertiary-theory rounded-3" style="background-color: rgba(211, 211, 211, 0.9); border-radius: 15px;">
            <div class="container-fluid py-5">
                

                <div class="parent d-flex">
                    <input class="form-control me-2" type="text" id="searchString" @bind="searchText" placeholder="Введите название вредителя" @oninput="popit">
                    <a >
                        <button class="btn btn-outline-success" type="submit" @onclick="popit">Найти</button>
                    </a>
                </div>

                <div class="row flex-lg-row-reverse align-items-center g-5 py-5">
                    <div class="col-10 col-sm-8 col-lg-6">
                        @*  <img src="https://pa1.aminoapps.com/7892/318138e30ef46c570aa8b2de1245506674589cd0r1-320-213_00.gif" class="d-block mx-lg-auto img-fluid" alt="Bootstrap Themes" width="700" height="500" loading="lazy"> *@
                        <img src="@linkImg" class="d-block mx-lg-auto img-fluid" alt="Bootstrap Themes" width="700" height="500" loading="lazy">
                    </div>
                    <div class="col-lg-6">
                        <h1 class="display-5 fw-bold text-body-emphasis lh-1 mb-3">@namess</h1>
                        <p class="lead">@theory</p>
                        <div class="d-grid gap-2 d-md-flex justify-content-md-start">
                            <button type="button" class="btn btn-primary btn-lg px-4 me-md-2" onclick="window.open('@linkWIki', '_blank');">Подробнее про @namess</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@code {

    newDesignPhenologicalcalendar.CallDB callDB = new newDesignPhenologicalcalendar.CallDB();

    string[] info = new string[4];

    private string searchText = string.Empty;

    private string notFound = "";

    private string namess = "Вредители";
    private string theory = "Вредитель — это животное, которое причиняет ущерб здоровью человека или его хозяйству, понимая последнее в самом широком смысле. Вредитель снижает урожайность и качество продукции, нанося тем самым огромный экономический ущерб.";
    private string linkImg = "https://belhp.by/upload/iblock/a84/18p4m1fos0s2z80jsspvdqvo39k01nu3.jpg";
    private string linkWIki = "https://ru.wikipedia.org/wiki/%D0%9E%D0%B2%D0%BE%D1%89%D0%BD%D1%8B%D0%B5_%D0%BA%D1%83%D0%BB%D1%8C%D1%82%D1%83%D1%80%D1%8B#:~:text=%D0%9E%D0%B2%D0%BE%D1%89%D0%BD%D1%8B%D0%B5%20%D0%BA%D1%83%D0%BB%D1%8C%D1%82%D1%83%D1%80%D1%8B%20%E2%80%94%20%D1%81%D0%B5%D0%BB%D1%8C%D1%81%D0%BA%D0%BE%D1%85%D0%BE%D0%B7%D1%8F%D0%B9%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%BE%D0%B2%D0%BE%D1%89%D0%BD%D1%8B%D0%B5%20%D1%80%D0%B0%D1%81%D1%82%D0%B5%D0%BD%D0%B8%D1%8F,%D0%BE%D0%B1%D1%8A%D0%B5%D0%B4%D0%B8%D0%BD%D1%8F%D0%B5%D0%BC%D1%8B%D1%85%20%D0%BF%D0%BE%D0%B4%20%D0%BA%D1%83%D0%BB%D0%B8%D0%BD%D0%B0%D1%80%D0%BD%D1%8B%D0%BC%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D0%B8%D0%B5%D0%BC%20%D0%BE%D0%B2%D0%BE%D1%89%D0%B8.";


    // string[] clue = new string[20];

    // public void clay()
    // {
    //     clue = callDB.calldbkak($"SELECT namess FROM theory");
    //     Console.WriteLine(clue);
    // }

    // static void HandleInput(ChangeEventArgs e)
    // {
    //     string searchText = e.Value.ToString();
    //     if (!string.IsNullOrEmpty(searchText) && searchText.Length == 1)
    //     {

    //         Console.WriteLine($"Первый введённый символ: {searchText}");
    //     }
    // }

    public void popit()
    {
        // clay();

        if (searchText != "")
        {
            info = callDB.calldbkak($"SELECT * FROM pests WHERE namess = '{searchText}'");

            if (info[1] == null)
            {
                notFound = "Культура не найдена";
            }
            else
            {
                namess = info[0];
                theory = info[1];
                linkImg = info[2];
                linkWIki = info[3];
            }
        }
        else
        {
            Console.WriteLine($"Пользователь написал {searchText}");
        }

    }
}


<style>
        .date-form-container {
            text-align: center;
        }
        .form-row {
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .form-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .form-group input {
            width: 80px;
        }
        .btn {
            margin-top: 10px;
        }
    </style>


<div>
    <div class="px-4 pt-5 my-5 text-center border-bottom">
        <h1 class="display-4 fw-bold text-body-emphasis">Расчтитать фенологический календарь</h1>
        <div class="col-lg-6 mx-auto">
            <div class="date-form-container">
                <EditForm Model="@dateModel" OnValidSubmit="@HandleValidSubmit">
                    <DataAnnotationsValidator />
                    <ValidationSummary />
            
                    <div class="form-row">
                        <div class="form-group">
                            <label for="day">День:</label>
                            <InputNumber id="day" @bind-Value="dateModel.Day" class="form-control" />
                        </div>
                        <div class="form-group">
                            <label for="month">Месяц:</label>
                            <InputNumber id="month" @bind-Value="dateModel.Month" class="form-control" />
                        </div>
                        <div class="form-group">
                            <label for="year">Год:</label>
                            <InputNumber id="year" @bind-Value="dateModel.Year" class="form-control" />
                        </div>
                    </div>
                    
                    		<div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
                    			@*<button type="button" class="btn btn-primary btn-lg px-4 gap-3">Информация</button>*@
                    			<button type="submit" class="btn btn-outline-secondary btn-lg px-4">Расчитать календарь</button>
                    			
                    		</div>
                    @*<button type="submit" class="btn btn-primary">Отправить</button>*@
                </EditForm>
            
                <p class="text-center">Введенная дата: @dateModel.Day/@dateModel.Month/@dateModel.Year</p>
            </div>
            @*<div class="d-grid gap-2 d-sm-flex justify-content-sm-center mb-5">
                <button type="button" class="btn btn-primary btn-lg px-4 me-sm-3">Primary button</button>
                <button type="button" class="btn btn-outline-secondary btn-lg px-4">Secondary</button>
            </div>*@
        </div>
        <div class="overflow-hidden" style="max-height: 30vh;">
            
        </div>
    </div>
</div>

@*<div class="date-form-container">
    <EditForm Model="@dateModel" OnValidSubmit="@HandleValidSubmit">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div class="form-row">
            <div class="form-group">
                <label for="day">День:</label>
                <InputNumber id="day" @bind-Value="dateModel.Day" class="form-control" />
            </div>
            <div class="form-group">
                <label for="month">Месяц:</label>
                <InputNumber id="month" @bind-Value="dateModel.Month" class="form-control" />
            </div>
            <div class="form-group">
                <label for="year">Год:</label>
                <InputNumber id="year" @bind-Value="dateModel.Year" class="form-control" />
            </div>
        </div>
        
        		<div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
        			$1$<button type="button" class="btn btn-primary btn-lg px-4 gap-3">Информация</button>#1#
        			<button type="submit" class="btn btn-outline-secondary btn-lg px-4">Расчитать календарь</button>
        			
        		</div>
        $1$<button type="submit" class="btn btn-primary">Отправить</button>#1#
    </EditForm>

    <p class="text-center">Введенная дата: @dateModel.Day/@dateModel.Month/@dateModel.Year</p>
</div>*@

@code {
    public class DateModel
    {
        public int Day { get; set; }
        public int Month { get; set; }
        public int Year { get; set; }
    }
    
    private DateModel dateModel = new DateModel();

    private void HandleValidSubmit()
    {
        // Логика обработки данных после отправки формы
        Console.WriteLine($"Дата: {dateModel.Day}/{dateModel.Month}/{dateModel.Year}");
    }
}



@if (data == null)
{
    <p>Loading...</p>
}
else
{
    <table class="table">
        <thead>
            <tr>
                <th>1</th>
                <th>2</th>
                <th>3</th>
                <th>4</th>
                <th>5</th>
                <th>6</th>
                <th>7</th>
                <th>8</th>
                <th>9</th>
                <th>10</th>
                <th>11</th>
                <th>12</th>
                <th>13</th>
                <th>14</th>
                <th>15</th>
                <th>16</th>
                <th>17</th>
                <th>18</th>
                <th>19</th>
                <th>20</th>
                <th>21</th>
                <th>22</th>
                <th>23</th>
                <th>24</th>
                <th>25</th>
                <th>26</th>
                <th>27</th>
                <th>28</th>
                <th>29</th>
                <th>30</th>
                <th>31</th>
                
            </tr>
        </thead>
        <tbody>
            @foreach (var row in data)
            {
                <tr>
                    <td>@row.Column1</td>
                    <td>@row.Column2</td>
                    <td>@row.Column3</td>
                    <td>@row.Column4</td>
                    <td>@row.Column5</td>
                                        <td>@row.Column6</td>
                                        <td>@row.Column7</td>
                                        <td>@row.Column8</td>
                                        <td>@row.Column9</td>
                                        <td>@row.Column10</td>
                                                            <td>@row.Column11</td>
                                                            <td>@row.Column12</td>
                                                            <td>@row.Column13</td>
                                                            <td>@row.Column14</td>
                                                            <td>@row.Column15</td>
                                                                                <td>@row.Column16</td>
                                                                                <td>@row.Column17</td>
                                                                                <td>@row.Column18</td>
                                                                                <td>@row.Column19</td>
                                                                                <td>@row.Column20</td>
                                                                                                    <td>@row.Column21</td>
                                                                                                    <td>@row.Column22</td>
                                                                                                    <td>@row.Column23</td>
                                                                                                    <td>@row.Column24</td>
                                                                                                    <td>@row.Column25</td>
                                                                                                                        <td>@row.Column26</td>
                                                                                                                        <td>@row.Column27</td>
                                                                                                                        <td>@row.Column28</td>
                                                                                                                        <td>@row.Column29</td>
                                                                                                                        <td>@row.Column30</td>
                    <td>@row.Column31</td>
                </tr>
            }
        </tbody>
    </table>
}

@code {
    private List<DataRow> data;

    protected override async Task OnInitializedAsync()
    {
        data = await DataService.GetDataAsync();
    }
}

@*<div class="container py-4">
	<form class="row g-3 needs-validation" novalidate>
      <div class="col-md-4">
        <label for="validationCustom01" class="form-label">First name</label>
        <input type="text" class="form-control" id="validationCustom01" value="Mark" required>
        <div class="valid-feedback">
          Looks good!
        </div>
      </div>
      <div class="col-md-4">
        <label for="validationCustom02" class="form-label">Last name</label>
        <input type="text" class="form-control" id="validationCustom02" value="Otto" required>
        <div class="valid-feedback">
          Looks good!
        </div>
      </div>
      <div class="col-md-4">
        <label for="validationCustomUsername" class="form-label">Username</label>
        <div class="input-group has-validation">
          <span class="input-group-text" id="inputGroupPrepend"></span>
          <input type="text" class="form-control" id="validationCustomUsername" aria-describedby="inputGroupPrepend" required>
          <div class="invalid-feedback">
            Please choose a username.
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <label for="validationCustom03" class="form-label">City</label>
        <input type="text" class="form-control" id="validationCustom03" required>
        <div class="invalid-feedback">
          Please provide a valid city.
        </div>
      </div>
      <div class="col-md-3">
        <label for="validationCustom04" class="form-label">State</label>
        <select class="form-select" id="validationCustom04" required>
          <option selected disabled value="">Choose...</option>
          <option>...</option>
        </select>
        <div class="invalid-feedback">
          Please select a valid state.
        </div>
      </div>
      <div class="col-md-3">
        <label for="validationCustom05" class="form-label">Zip</label>
        <input type="text" class="form-control" id="validationCustom05" required>
        <div class="invalid-feedback">
          Please provide a valid zip.
        </div>
      </div>
      <div class="col-12">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" value="" id="invalidCheck" required>
          <label class="form-check-label" for="invalidCheck">
            Agree to terms and conditions
          </label>
          <div class="invalid-feedback">
            You must agree before submitting.
          </div>
        </div>
      </div>
      <div class="col-12">
        <button class="btn btn-primary" type="submit">Submit form</button>
      </div>
    </form>
	<div class="row flex-lg-row-reverse align-items-center">
		$1$ <div class="col-10 col-sm-8 col-lg-6">
			<img src="https://sun9-10.userapi.com/impg/x1CkhEmvWN6o2aKFZ5nqK_lk6-SQd6E25kc-5Q/mivt4bhPJjY.jpg?size=2560x1695&quality=95&sign=7509339e9f89f4ac1cc29bf2b7d97bef&type=album" class="d-block mx-lg-auto img-fluid" alt="Bootstrap Themes" width="700" height="500" loading="lazy">
		</div> #1#
		<div class="col-10 col-sm-8 col-lg-6">
			<input type="date" min="2023-01-01" max="2025-12-31">
			$1$ 			<input type="month">
			<input type="week"> #1#
		</div>
		<div class="col-lg-6">
			<h1 class="display-5 fw-bold text-body-emphasis lh-1 mb-3">Вредители</h1>
			<p class="lead">Вредитель — это животное, которое причиняет ущерб здоровью человека или его хозяйству, понимая последнее в самом широком смысле</p>

			<div class="d-grid gap-2 d-md-flex justify-content-md-start">

				$1$ 				<button type="button" class="btn btn-primary btn-lg px-4 me-md-2">Говно</button>
				<button type="button" class="btn btn-outline-secondary btn-lg px-4">Моча</button> #1#
			</div>
		</div>
	</div>
</div>*@



<footer class="pt-3 mt-4 text-body-secondary border-top">
<p align="center" style="font-size: 10px;">
    <br>
    Все права защищены. Авторы проекта не несут ответственности
    за точность прогнозов погоды и за возможные негативные<br>
    последствия, возникшие при использовании информации с сайта.
    Прогностическая информация на сайте носит исключительно<br>
    ознакомительный характер и ее перепечатка в СМИ запрещена.
    Для принятия решений необходимо руководствоваться официальными<br>
    прогнозами погоды Гидрометцентра России.  © 2024 <br>

</p>
</footer>